<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced HZ Generator</title>

<style>
    body {
        background: #0d0d0f;
        color: #fff;
        font-family: Arial, sans-serif;
        padding: 20px;
        text-align: center;
    }

    h1 {
        font-size: 40px;
        color: #79aaff;
        margin-bottom: 30px;
        animation: glow 2s infinite alternate;
    }

    @keyframes glow {
        from { text-shadow: 0 0 5px #79aaff; }
        to   { text-shadow: 0 0 20px #79aaff; }
    }

    .box {
        background: #151519;
        padding: 20px;
        border-radius: 12px;
        border: 1px solid #2a2a2f;
        width: 90%;
        max-width: 600px;
        margin: 20px auto;
        box-shadow: 0 0 20px #000;
        transition: 0.3s;
    }

    .box:hover {
        transform: scale(1.02);
        box-shadow: 0 0 30px #1b1b25;
    }

    input[type=range] {
        width: 100%;
    }

    select {
        padding: 10px;
        width: 90%;
        background: #222;
        color: white;
        border-radius: 8px;
        border: 1px solid #444;
        font-size: 18px;
    }

    .btn {
        padding: 15px 40px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 20px;
        margin: 10px;
        transition: 0.2s;
        color: white;
        background: #2374ff;
    }

    .btn:hover {
        transform: scale(1.05);
        background: #1a5ed6;
    }

    .btn-stop {
        background: #d92626;
    }

    .btn-stop:hover {
        background: #ff3535;
    }

    canvas {
        width: 100%;
        height: 150px;
        background: black;
        border-radius: 10px;
        margin-top: 20px;
    }
</style>
</head>
<body>

<h1>âš¡ Advanced HZ Generator</h1>

<div class="box">
    <h2>Frequency: <span id="hzValue">440</span> Hz</h2>
    <input type="range" id="hzSlider" min="1" max="300000" value="440" oninput="updateHz()">
</div>

<div class="box">
    <h2>Volume: <span id="volumeValue">50</span>%</h2>
    <input type="range" id="volumeSlider" min="0" max="100" value="50" oninput="updateVolume()">
</div>

<div class="box">
    <h2>Wave Type</h2>
    <select id="waveType" onchange="updateWave()">
        <option value="sine">Sine</option>
        <option value="square">Square</option>
        <option value="triangle">Triangle</option>
        <option value="sawtooth">Sawtooth</option>
    </select>
</div>

<div class="box">
    <button class="btn" onclick="startTone()">Start</button>
    <button class="btn btn-stop" onclick="stopTone()">Stop</button>
</div>

<div class="box">
    <h2>Waveform Display (Oscilloscope)</h2>
    <canvas id="oscilloscope"></canvas>
</div>

<div class="box">
    <h2>Presets</h2>
    <button class="btn" onclick="savePreset()">Save Preset</button>
    <button class="btn" onclick="loadPreset()">Load Preset</button>
</div>

<script>
let audioCtx, oscillator, gainNode, analyser, dataArray;

function updateHz() {
    const hz = document.getElementById("hzSlider").value;
    document.getElementById("hzValue").innerText = hz;
    if (oscillator) oscillator.frequency.value = hz;
}

function updateVolume() {
    const vol = document.getElementById("volumeSlider").value;
    document.getElementById("volumeValue").innerText = vol;
    if (gainNode) gainNode.gain.value = vol / 100;
}

function updateWave() {
    if (oscillator) oscillator.type = document.getElementById("waveType").value;
}

function startTone() {
    const hz = document.getElementById("hzSlider").value;
    const volume = document.getElementById("volumeSlider").value;
    const wave = document.getElementById("waveType").value;

    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    oscillator = audioCtx.createOscillator();
    gainNode = audioCtx.createGain();
    analyser = audioCtx.createAnalyser();

    oscillator.frequency.value = hz;
    gainNode.gain.value = volume / 100;
    oscillator.type = wave;

    oscillator.connect(gainNode);
    gainNode.connect(analyser);
    analyser.connect(audioCtx.destination);

    oscillator.start();
    drawOscilloscope();
}

function stopTone() {
    if (oscillator) oscillator.stop();
    if (audioCtx) audioCtx.close();
}

function savePreset() {
    const preset = {
        hz: document.getElementById("hzSlider").value,
        volume: document.getElementById("volumeSlider").value,
        wave: document.getElementById("waveType").value
    };
    localStorage.setItem("soundPreset", JSON.stringify(preset));
    alert("Preset saved!");
}

function loadPreset() {
    const preset = JSON.parse(localStorage.getItem("soundPreset"));
    if (!preset) return alert("No preset saved!");

    document.getElementById("hzSlider").value = preset.hz;
    document.getElementById("volumeSlider").value = preset.volume;
    document.getElementById("waveType").value = preset.wave;

    updateHz();
    updateVolume();
    updateWave();

    alert("Preset loaded!");
}

function drawOscilloscope() {
    const canvas = document.getElementById("oscilloscope");
    const ctx = canvas.getContext("2d");

    analyser.fftSize = 2048;
    dataArray = new Uint8Array(analyser.fftSize);

    function draw() {
        requestAnimationFrame(draw);
        analyser.getByteTimeDomainData(dataArray);

        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.lineWidth = 2;
        ctx.strokeStyle = "#00ffea";
        ctx.beginPath();

        let slice = canvas.width / analyser.fftSize;
        let x = 0;

        for (let i = 0; i < analyser.fftSize; i++) {
            let v = dataArray[i] / 128.0;
            let y = (v * canvas.height) / 2;

            if (i === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);

            x += slice;
        }
        ctx.stroke();
    }

    draw();
}
</script>

</body>
</html>
